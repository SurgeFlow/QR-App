datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Equipment {
  id           String        @id @default(uuid())
  shortId      String        @unique
  serialNumber String?
  model        String?
  location     String?
  installedAt  DateTime?
  notes        String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  qrcodes      QrCode[]
  reports      ServiceReport[]
}

model QrCode {
  id             String    @id @default(cuid())
  equipmentId    String
  equipment      Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade)
  encryptedToken String
  createdAt      DateTime  @default(now())
}

model ServiceReport {
  id           String    @id @default(cuid())
  equipmentId  String
  equipment    Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade)
  tokenSnapshot String
  description  String?
  photoPaths   String     // JSON array string
  status       String     @default("Open")
  internalNotes String?
  createdAt    DateTime  @default(now())
}